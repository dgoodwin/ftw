<%= breadcrumb(:league => @race.event.season.league, :season => @race.event.season,
               :event => @race.event) %>

<h2>Heat <%= @race.index %></h2>

<p>
  <b>Time:</b>
  <%= @race.time %>
</p>

<p>
  <b>Host:</b>
<% if @race.host %>
  <%= link_to @race.host.get_account('psn').name, user_path(@race.host) %>
<% elsif have_perm('host_race', @race.event.season.league.id) %>
  <%= link_to 'Host Race', :controller => "races", :action => "host", :id => @race %>
<% end %>
</p>

<p>
  <b>Instructions:</b>
  <%= @race.event.instructions %>
</p>

<p>
<b>Users:</b>
<ul>
  <% @race.users.each do |user| %>
    <li><%= link_to user.get_account('psn').name, user_path(user) %></li>
  <% end %>
</ul>
</p>

<p>
<h2>Results</h2>
<p>Currently, only one set of results can be submitted. Eventually any user in the race will be able to submit results, and league admins will be responsible for assembling or approving the final results.</p>
<%= link_to_if @race.race_results.length == 0, 'Submit Results', new_race_result_path(:race_id => @race) %>
</p>
  <% @race.race_results.each do |result| %>
    <hr>
    <%= render :partial => 'race_results/show_inline',
        :locals => { :race_result => result, :league => @race.event.season.league} %>
    <hr>
  <% end %>
</p>

<p>

<%= link_to 'Edit', edit_race_path(@race) %> |
<%= link_to 'Back', races_path %>
